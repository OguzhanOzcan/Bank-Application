<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <h3 class="text-center mb-4">Şifremi Unuttum</h3>

      <form *ngIf="step === 'email'" [formGroup]="emailForm" (ngSubmit)="sendEmail()">
        <div *ngIf="serverErrorMessage" class="alert alert-danger mt-2">
          {{ serverErrorMessage }}
        </div>
        <div class="form-group">
          <label for="email">E-posta</label>
          <input type="email" id="email" class="form-control" formControlName="email" placeholder="E-posta adresinizi girin"
                 (blur)="emailForm.get('email')?.markAsTouched()">
          <div *ngIf="emailForm.get('email')?.touched && emailForm.get('email')?.invalid" class="text-danger mt-1">
            Geçerli bir e-posta giriniz.
          </div>
        </div>
        <button type="submit" class="btn btn-primary btn-block" [disabled]="isLoading">Gönder</button>
      </form>

      <form *ngIf="step === 'code'" [formGroup]="codeForm" (ngSubmit)="verifyCode()">
        <div *ngIf="serverErrorMessage" class="alert alert-danger mt-2">
          {{ serverErrorMessage }}
        </div>
        <div class="form-group">
          <label for="code">Doğrulama Kodu</label>
          <input type="text" id="code" class="form-control" formControlName="code" placeholder="6 haneli kodu girin"
                 (blur)="codeForm.get('code')?.markAsTouched()">
          <div *ngIf="codeForm.get('code')?.touched && codeForm.get('code')?.invalid" class="text-danger mt-1">
            Lütfen 6 haneli kodu giriniz.
          </div>
        </div>
        <div class="text-muted mb-3">
          Kalan süre: {{ countdown }} saniye
        </div>
        <button type="submit" class="btn btn-primary btn-block" [disabled]="isLoading">Doğrula</button>
      </form>

      <form *ngIf="step === 'reset'" [formGroup]="resetPasswordForm" (ngSubmit)="resetPassword()">
        <div class="form-group">
          <label for="password">Yeni Şifre</label>
          <input type="password" id="password" class="form-control" formControlName="password"
                 (blur)="resetPasswordForm.get('password')?.markAsTouched()">
          <div *ngIf="resetPasswordForm.get('password')?.touched && resetPasswordForm.get('password')?.invalid" class="text-danger mt-1">
            Şifre 6 karakterden uzun olmalı, en az 1 harf, 1 sayı ve 1 özel karakter içermeli.
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Şifre Tekrar</label>
          <input type="password" id="confirmPassword" class="form-control" formControlName="confirmPassword"
                 (blur)="resetPasswordForm.get('confirmPassword')?.markAsTouched()">
          <div *ngIf="resetPasswordForm.get('confirmPassword')?.touched && resetPasswordForm.get('confirmPassword')?.hasError('passwordMismatch')" class="text-danger mt-1">
            Şifreler eşleşmiyor.
          </div>
        </div>
        <button type="submit" class="btn btn-success btn-block mt-3">Şifreyi Sıfırla</button>
      </form>

    </div>
  </div>
</div>
